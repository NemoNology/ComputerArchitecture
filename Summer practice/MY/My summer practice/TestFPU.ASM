FORMAT	MZ
ORG 100H

; Вычисление длины отрезка
; по координатам его точек

; Тестовые занчения: A(1, 1); B(2, 3); L = 2.236..




MOV	SI, X
MOV	DI, Y

; Регистр CL будет выступать в роли счётчика
MOV	CL, 0


; Координаты должны находиться в 2-ух массивах:
; 1) Массив с x1..x10            Адрес начала массива должен лежать в SI
; 2) Массив с y1..y10            Адрес начала массива должен лежать в DI
; Оба массива должны заканчиваться
; Результат будет распологаться в стеке BX
FindLength:

	@Loop:

					;       |  |  |  |  |  |  |  |  |
		FILD	DWORD [SI]	;       |x1|  |  |  |  |  |  |  |
		INC	SI		;       xn -> xn+1
		FILD	DWORD [SI]	;       |x2|x1|  |  |  |  |  |  |
		FSUB	ST0, ST1	;       |a1|x1|  |  |  |  |  |  | a1 = x2 - x1
		FLD	ST0		;       |a1|a1|x1|  |  |  |  |  |
		FMUL	ST0, ST1	;       |a3|a1|x1|  |  |  |  |  | a2 = a1^2
		FILD	DWORD [DI]	;       |y1|a3|a1|x1|  |  |  |  |
		INC	DI		;       yn -> yn+1
		FILD	DWORD[DI]	;       |y2|y1|a3|a1|x1|  |  |  |
		FSUB	ST0, ST1	;       |a2|y1|a3|a1|x1|  |  |  | a3 = y2 - y1
		FLD	ST0		;       |a2|a2|y1|a3|a1|x1|  |  |
		FMUL	ST0, ST1	;       |a4|a2|y1|a3|a1|x1|  |  | a4 = a3^2
		FADD	ST0, ST3	;       |a5|a2|y1|a3|a1|x1|  |  | a5 = a3 + a4
		FSQRT			;       |a6|a2|y1|a3|a1|x1|  |  | a6 = sqrt(a5)
		;FRNDINT

		FISTP	[R]

		FSTP	[q]		;       |a2|y1|a3|a1|x1|  |  |  |
		FSTP	[q]		;       |y1|a3|a1|x1|  |  |  |  |
		FSTP	[q]		;       |y1|a3|a1|x1|  |  |  |  |
		FSTP	[q]		;       |a3|a1|x1|  |  |  |  |  |
		FSTP	[q]		;       |a1|x1|  |  |  |  |  |  |
		FSTP	[q]		;       |x1|  |  |  |  |  |  |  |


		MOV	BX, WORD [R]
		PUSH	BX

		INC	CL

		CMP	CL, N
		JNE	@Loop




; Чтение нажатия перед закрытием
MOV AH, 01H
INT 21H



; Закрытие консоли
MOV AH, 4CH
INT 21H




; Объявление первоначальных переменных для будущей работы в FPU
; Введены тестовые значения
X DB 1, -1, -5, -5, -2,  1,  5, 7,  2, 2
Y DB 1,  3,  1, -4, -2, -7, -4, 6, 10, 3

; q - переменная
; для очистки стека
q DD ?

; Кол-во углов в прямоугольнике
N = 10


; Переменная для сохранения результата
R DD ?




